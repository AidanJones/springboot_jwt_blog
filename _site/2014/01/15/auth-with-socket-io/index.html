<!DOCTYPE html>
<html class="header-dark">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="description" content="Learn to implement token-based authentication using Socket.IO in this quick tutorial.">
    
    <meta name="keywords" content="featured">
    

    <!-- <meta property="fb:admins" content="YOUR_FB_USER_ID" /> -->
<meta property="fb:app_id" content="534074790006350"/>
<meta property="og:title" content="Token-based Authentication with Socket.IO" />
<meta property="og:site_name" content="Auth0 - Blog" />
<meta property="og:url" content="https://auth0.com/blog/2014/01/15/auth-with-socket-io/" />

<meta name="og:image" content="http://assets.auth0.com/blog/design-process/socket-io.png">



<meta property="og:description" content="Learn to implement token-based authentication using Socket.IO in this quick tutorial." />



<meta property="og:type" content="article">


<!-- Twitter Cards -->
<meta name="twitter:card" content="summary">

<meta name="twitter:image" content="http://assets.auth0.com/blog/design-process/socket-io.png">

<meta name="twitter:title" content="Token-based Authentication with Socket.IO">
<meta name="twitter:description" content="Learn to implement token-based authentication using Socket.IO in this quick tutorial.">
<meta name="twitter:creator" content="@auth0">

<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">


    <title>Token-based Authentication with Socket.IO</title>

    <script src="//use.typekit.net/tde2fii.js"></script>
    <script>try{Typekit.load();}catch(e){}</script>

    <script type="text/javascript" src="//cdn.auth0.com/js/lock-6.min.js"></script>
    <script type="text/javascript" src="//cdn.auth0.com/web-header/latest/standalone.min.js"></script>
    <link rel="stylesheet" href="//cdn.auth0.com/web-header/latest/standalone.min.css" />

    

    

    
    <link rel="canonical" href="/blog/2014/01/15/auth-with-socket-io/" />
    

    <link rel="shortcut icon" href="//cdn.auth0.com/styleguide/latest/lib/logos/img/favicon.png">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="http://feeds.feedburner.com/auth0">
    <link type="application/opensearchdescription+xml" rel="search" href="/osd.xml"/>

    <link href="//cdn.auth0.com/styleguide/latest/index.css" rel="stylesheet">

    <link rel="stylesheet" href="/blog/css/index.css" />

    <script type="text/javascript">
      var segmentKey =  'WqErZyd56ob3pmMDnko55hNgFt8B4Zox' ;
      !function(){var analytics=window.analytics=window.analytics||[];if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","group","track","ready","alias","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t){var e=document.createElement("script");e.type="text/javascript";e.async=!0;e.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)};analytics.SNIPPET_VERSION="3.0.0";
        analytics.load(segmentKey);
        analytics.page();
      }}();
    </script>
</head>
<body>
    
<!-- Facebook -->
<div id="fb-root"></div>
<script>
  (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&appId=534074790006350&version=v2.0";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));
</script>

<!-- Twitter -->
<script type="text/javascript">
  !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');
</script>

<!-- Google+ -->
<!--
<script type="text/javascript">
  (function() {
    var po = document.createElement('script');
    po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(po, s);
  })();
</script>
-->


    <header class="site-header clearfix">
    </header>
    <script type="text/javascript">
      (function() {
        var header = new WebHeader({ base_url: 'https://auth0.com' });
        header.render('header.site-header');
      })();
    </script>

    
    <!-- Twitter Conversion -->
<script src="//platform.twitter.com/oct.js" type="text/javascript"></script>
<script type="text/javascript">
  twttr.conversion.trackPid('l4rua');
</script>

<noscript>
  <img height="1" width="1" style="display:none;" alt="" src="https://analytics.twitter.com/i/adsct?txn_id=l4rua&p_id=Twitter" />
  <img height="1" width="1" style="display:none;" alt="" src="//t.co/i/adsct?txn_id=l4rua&p_id=Twitter" />
</noscript>






<div class="banner banner-post" style="background: #030303">
    <div class="container banner-container">
        <i class="icon-budicon-697 hide"></i>

        <h1><a href="/blog/">Blog</a></h1>

        












  <a href="/blog/2014/01/15/auth-with-socket-io/" 
    style="
 
 
 
  border-radius: 0;
 
"
    class="entry-thumbnail">
    <img 
    style="
  
 
  
 
  
 
  
"
    src="http://assets.auth0.com/blog/design-process/socket-io.png"
    alt="Token-based Authentication with Socket.IO">
  </a>


        <h2 class="entry-title"><a href="/blog/2014/01/15/auth-with-socket-io/" title="Published: January 15, 2014">Token-based Authentication with Socket.IO</a></h2>

        
        <div class="entry-content">
          <p>Learn to implement token-based authentication using Socket.IO in this quick tutorial.</p>

        </div>
        

        <div class="post-info">
          <div class="author">
            <a href="http://joseoncode.com"><img src="https://secure.gravatar.com/avatar/d1a7e0fbfb2c1d9a8b10fd03648da78f.png" width="27" height="27"> <span class="name">Jos√© F. Romaniello</span></a>
          </div>

          <div class="date">
            <time datetime="January 15, 2014" class="published updated">January 15, 2014</time>
          </div>

          <div class="social-stats">
  <a href="#" data-url="https://auth0.com/blog/2014/01/15/auth-with-socket-io/" data-type="twitter" data-count="true" class="network">
    
    <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="22" height="22" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve">

    <path id="twitter-icon" d="M462,128.223c-15.158,6.724-31.449,11.269-48.547,13.31c17.449-10.461,30.854-27.025,37.164-46.764

      c-16.333,9.687-34.422,16.721-53.676,20.511c-15.418-16.428-37.386-26.691-61.698-26.691c-54.56,0-94.668,50.916-82.337,103.787

      c-70.25-3.524-132.534-37.177-174.223-88.314c-22.142,37.983-11.485,87.691,26.158,112.85c-13.854-0.438-26.891-4.241-38.285-10.574

      c-0.917,39.162,27.146,75.781,67.795,83.949c-11.896,3.237-24.926,3.978-38.17,1.447c10.754,33.58,41.972,58.018,78.96,58.699

      C139.604,378.282,94.846,390.721,50,385.436c37.406,23.982,81.837,37.977,129.571,37.977c156.932,0,245.595-132.551,240.251-251.435

      C436.339,160.061,450.668,145.174,462,128.223z"/>

    </svg>

  </a>

  <a href="#" data-url="https://auth0.com/blog/2014/01/15/auth-with-socket-io/" data-type="linkedin" data-count="true" class="network">
    <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="22" height="22" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve">

    <path id="linkedin-icon" d="M411.945,50h-312c-27.614,0-50,22.386-50,50v312c0,27.614,22.386,50,50,50h312

      c27.614,0,50-22.386,50-50V100C461.945,72.386,439.56,50,411.945,50z M180.996,392.99h-56.537V210.336h56.537V392.99z

       M152.457,186.417c-18.465,0-33.432-15.09-33.432-33.703c0-18.614,14.967-33.704,33.432-33.704c18.463,0,33.432,15.09,33.432,33.704

      C185.889,171.327,170.92,186.417,152.457,186.417z M392.865,392.99h-56.262c0,0,0-69.582,0-95.881

      c0-26.296-9.988-40.974-30.781-40.974c-22.629,0-34.453,15.289-34.453,40.974c0,28.133,0,95.881,0,95.881h-54.223V210.336h54.223

      v24.599c0,0,16.309-30.171,55.041-30.171s66.455,23.648,66.455,72.572C392.865,326.262,392.865,392.99,392.865,392.99z"/>

    </svg>
  </a>

  <a href="#" data-url="https://auth0.com/blog/2014/01/15/auth-with-socket-io/" data-type="facebook" data-count="true" class="network">
    <svg width="17" height="17" viewBox="0 0 412 412" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
      <g id="facebook-icon" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">
          <path d="M283.80119,412 L361.995375,412 C389.611494,412 412,389.612167 412,361.995375 L412,50.0046252 C412,22.3885058 389.612167,0 361.995375,0 L50.0046252,0 C22.3885058,0 0,22.3878333 0,50.0046252 L0,361.995375 C0,389.611494 22.3878333,412 50.0046252,412 L219.907783,412 L219.907783,254.137637 L166.482996,254.137637 L166.482996,192.266054 L219.907783,192.266054 L219.907783,146.637452 C219.907783,93.6867027 252.247398,64.8530656 299.484232,64.8530656 C322.110827,64.8530656 341.559134,66.5376524 347.225329,67.2916602 L347.225329,122.6301 L314.462578,122.644417 C288.775412,122.644417 283.80119,134.851707 283.80119,152.764958 L283.80119,192.266054 L345.068293,192.266054 L337.089173,254.137637 L283.80119,254.137637 L283.80119,412 Z" id="Rectangle-1" fill="#000000" sketch:type="MSShapeGroup"></path>
      </g>
    </svg>
  </a>
</div>
        </div>

    </div>
</div>

<div id="container" class="container">
    <div class="blog-post blog-single">
        <div class="inner">
            <div class="entry-content" >
            <h2>Introduction</h2>

<p>Authentication in realtime frameworks can be challenging. Perhaps this is because the way these systems work is quite different from a regular web app. The risk of not correctly authenticating your sockets traffic is that you could end up sniffing information on other users streams. <strong>The socket server will not automagically know about the logged-in user, thus anyone could join any stream</strong>.</p>

<!-- more -->


<p>This first diagram shows this common misconception:</p>

<p><a href="https://docs.google.com/a/auth10.com/drawings/d/1_t1TV5CqUutrj3I7iTg3_u0z2ep4sEvV8gP7gC7ejqU" target="_blank"><img title="Session cookie authentication does not mean sockets are authenticated" src="https://docs.google.com/drawings/d/1_t1TV5CqUutrj3I7iTg3_u0z2ep4sEvV8gP7gC7ejqU/pub?w=509&h=536" />
</a></p>

<blockquote><p>It is a common misconception that a user who is authenticated in the hosting web appliction, is also authenticated in the socket stream. These are two completely different channels.</p></blockquote>

<h2>Cookie-based and Token-based Auth</h2>

<p>There are two ways of solving this problem: the traditional cookie-based approach or a token-based approach. The following diagram explains how each of these methods work:</p>

<p><a href="https://docs.google.com/drawings/d/1RNkaJ7wHXBLlg3YAdtBOrOb5uxj_6oiNQ-96-YA8X74" target="_blank"><img title="socket.io auth token vs cookiesokies" src="https://docs.google.com/drawings/d/1RNkaJ7wHXBLlg3YAdtBOrOb5uxj_6oiNQ-96-YA8X74/pub?w=990&amp;h=529" />
</a></p>

<p>In our previous article, we wrote about the benefits of a token-based architecture: <a href="http://blog.auth0.com/2014/01/07/angularjs-authentication-with-cookies-vs-token/">Cookies vs Tokens.  Getting auth right with Angular.JS</a>. Here are some specific considerations with cookies and realtime frameworks:</p>

<ul>
<li><strong>Coupling</strong>: the first issue when using cookies is that you have to couple the web application authentication mechanism with the socket server authentication. This might be ok in some cases, but it means you are tied to the semantics of the authentication framework which was written with a specific web use case in mind. e.g.: the session cookie is handled by the web framework and you don't have access to that easily unless you know the internals.</li>
<li><strong>Hard to configure</strong>: The configuration is error prone. A year ago I wrote <a href="http://github.com/jfromaniello/passport.socketio">passport-socketio</a> that basically bridges the passport information stored in the express session with socket.io auth. Looking at the <a href="http://github.com/jfromaniello/passport.socketio/issues">issues</a>, most of the problems are related to the configuration or people being unfamiliar with <code>passport.js</code>.</li>
<li><strong>Not ready for devices</strong>: If you are connecting to a socket from a device, cookies are not there (well, they are but you have to get into cookie containers and what not), so you end up implementing something different for a device.</li>
<li><strong>Requires session configuration</strong>: you have to rely on a session store (e.g. Mongodb, Redis, or store the session on a cookie).</li>
<li><strong>PHP + Socket.IO</strong>: Reading the PHP cookie and session from node is not easy, <a href="http://simplapi.wordpress.com/2012/04/13/php-and-node-js-session-share-redi/">here is a blogpost explaining it</a>. Same thing applies to other technologies (django, java, etc.).</li>
</ul>


<h2>Authenticating Sockets using Tokens</h2>

<p>By now you should not be surprised if we proposed a different alternative to cookies: using tokens. Let's look at a simple sample that uses <a href="http://expressjs.com/">express</a>, <a href="http://socket.io">socket.io</a> and handles authentication using Json Web Tokens (JWT).</p>

<h3>Server Side</h3>

<p>Code speaks by itself. Focus on the <code>/login</code> and the usage of <code>socketioJwt.authorize</code>.</p>

<pre><code>var jwt = require('jsonwebtoken');
// other requires

app.post('/login', function (req, res) {

  // TODO: validate the actual user user
  var profile = {
    first_name: 'John',
    last_name: 'Doe',
    email: 'john@doe.com',
    id: 123
  };

  // we are sending the profile in the token
  var token = jwt.sign(profile, jwtSecret, { expiresInMinutes: 60*5 });

  res.json({token: token});
});

var server = http.createServer(app);
</code></pre>

<p>Then the socket.io server</p>

<pre><code>var socketioJwt = require('socketio-jwt');

var sio = socketIo.listen(server);

sio.set('authorization', socketioJwt.authorize({
  secret: jwtSecret,
  handshake: true
}));

sio.sockets
  .on('connection', function (socket) {
     console.log(socket.handshake.decoded_token.email, 'connected');
     //socket.on('event');
  });

server.listen(9000, function () {
  console.log('listening on http://localhost:9000');
});
</code></pre>

<p>The JWT is signed with the <code>jwtSecret</code> which is stored only on the server.</p>

<p>Here we are using the <a href="https://github.com/LearnBoost/socket.io/wiki/Authorizing">global authorization callback</a> on socket.io. We are also using a simple module wrote (<a href="https://github.com/auth0/socketio-jwt">socketio-jwt</a>) to help us with the details of handling the JWT. This module expects the JWT in the querystring during the handshake.</p>

<p>If the client sends a valid JWT, the handshake completes successfully and the <code>connection</code> event is triggered.</p>

<h3>Client Side</h3>

<p>A simple js client side code that uses this server is shown bellow:</p>

<pre><code>function connect_socket (token) {
  var socket = io.connect('', {
    query: 'token=' + token
  });

  socket.on('connect', function () {
    console.log('authenticated');
  }).on('disconnect', function () {
    console.log('disconnected');
  });
}

$('#login').submit(function (e) {
  e.preventDefault();
  $.post('/login', {
    username: $('username').val(),
    password: $('password').val()
  }).done(function (result) {
    connect_socket(result.token);
  });
});
</code></pre>

<p>As stated before, this is much simpler than using cookies and sessions, and it is much easier to implement across different technologies.</p>

<p>The complete sample is available for <a href="https://github.com/auth0/socketio-jwt/tree/master/example">download here</a>.</p>

<p>You could use a very similar approach with WebSockets, <a href="https://gist.github.com/jfromaniello/8418116">this is an example with <strong>einaros/ws</strong></a>.</p>

            </div>

            

            <div class="try-banner">
                <span>Try Auth0 for FREE</span>
                <a href="javascript:signup()" class="signup-button btn btn-success btn-lg">Create free Account</a>
            </div>

            

<p class="small-caps text-center">Recent Posts</p>

<div class="related-posts">

  

  

  <div class="entry-related">
    












  <a href="/blog/2015/05/04/design-at-auth0/" 
    style="
 
  background: #222229;
 
 
 
"
    class="entry-thumbnail">
    <img 
    style="
  
 
  
  max-width: 170%;
  
 
  
  top: 52%;
  
 
  
"
    src="http://assets.auth0.com/blog/design-process/badge.png"
    alt="Engineering the Design Process at Auth0">
  </a>


    <h2 class="entry-title"><a href="/blog/2015/05/04/design-at-auth0/" title="Published: May 04, 2015">Engineering the Design Process at Auth0</a></h2>
  </div>

  

  

  <div class="entry-related">
    












  <a href="/blog/2015/04/28/announcing-auth0-sso-dashboard/" 
    style="
 
 
 
"
    class="entry-thumbnail">
    <img 
    style="
  
  opacity: 0.8;
  
 
  
  max-width: 200%;
  
 
  
 
  
"
    src="https://cloudup.com/cfENOYpKxfL+"
    alt="Announcing the Auth0 Open Source Single-Sign-On Dashboard">
  </a>


    <h2 class="entry-title"><a href="/blog/2015/04/28/announcing-auth0-sso-dashboard/" title="Published: April 28, 2015">Announcing the Auth0 Open Source Single-Sign-On Dashboard</a></h2>
  </div>

  

  

  <div class="entry-related">
    












  <a href="/blog/2015/04/27/auth0-europe-launches/" 
    style="
 
 
 
"
    class="entry-thumbnail">
    <img 
    style="
  
 
  
  max-width: 155%;
  
 
  
 
  
"
    src="https://cldup.com/C76gL6oGIE.png"
    alt="Auth0 Europe Launches">
  </a>


    <h2 class="entry-title"><a href="/blog/2015/04/27/auth0-europe-launches/" title="Published: April 27, 2015">Auth0 Europe Launches</a></h2>
  </div>

</div>

            <div id="disqus_thread">
            </div>
        </div>
    </div>
    <br />
</div>

<g:plusone annotation="inline"></g:plusone>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'auth0blog'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="//disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>



    <div class="container">
      <footer class="site-footer clearfix">
        <div class="logo"><img src=
        "https://cdn.auth0.com/styleguide/1.0.0/img/badge.png" width="30"></div>

        <div class="footer-grid">
          <div class="column">
            <div class="item">
              <h6>Product</h6>
            </div>

            <div class="item">
              <a href="/pricing">Pricing</a>
            </div>

            <div class="item">
              <a href="/why-auth0">Why Auth0</a>
            </div>

            <div class="item">
              <a href="/how-it-works">How It Works</a>
            </div>
          </div>

          <div class="column">
            <div class="item">
              <h6>Company</h6>
            </div>

            <div class="item">
              <a href="/about">About Us</a>
            </div>

            <div class="item">
              <a href="/blog">Blog</a>
            </div>

            <div class="item">
              <a href="/jobs">Jobs</a>
            </div>
          </div>

          <div class="column">
            <div class="item">
              <h6>Security</h6>
            </div>

            <div class="item">
              <a href="/availability-trust">Availability &amp; Trust</a>
            </div>

            <div class="item">
              <a href="/security">Security</a>
            </div>

            <div class="item">
              <a href="/whitehat">White Hat</a>
            </div>
          </div>

          <div class="column">
            <div class="item">
              <h6>Learn</h6>
            </div>

            <div class="item">
              <a href="/support">Help &amp; Support</a>
            </div>

            <div class="item">
              <a href="https://auth0.com/docs">Documentation</a>
            </div>

            <div class="item">
              <a href="/opensource">Open Source</a>
            </div>
          </div>

          <div class="column">
            <div class="item">
              <h6>Extend</h6>
            </div>

            <div class="item">
              <a href="/lock">Lock</a>
            </div>

            <div class="item">
              <a href="/wordpress">Wordpress</a>
            </div>

            <div class="item">
              <a href="https://auth0.com/docs/apiv2">API Explorer</a>
            </div>
          </div>

          <div class="contact">
            <div class="column">
              <div class="item">
                <h6>Contact</h6>
              </div>

              <div class="item">
                <a href="mailto:support@auth0.com">Email Us</a>
              </div>

              <div class="item">
                10777 Main Street<br>
                Suite 204<br>
                Bellevue, WA 98004
              </div>
            </div>

            <div class="column no-heading">
              <div class="item">
                <a href="tel:+18882352699">+1 (888) 235-2699</a>
              </div>

              <div class="item">
                <a href="tel:+14253126521">+1 (425) 312-6521</a>
              </div>
            </div>
          </div>
        </div>

        <div class="colophon">
          <div class="column">
            <div class="social">
              <div class="twitter">
                <iframe class="twitter" frameborder="0" scrolling="no" src=
                "//platform.twitter.com/widgets/follow_button.html?screen_name=auth0">
                </iframe>
              </div>

              <div class="facebook">
                <iframe class="facebook" frameborder="0" scrolling="no" src=
                "//www.facebook.com/plugins/like.php?href=https%3A%2F%2Ffacebook.com%2Fgetauth0&amp;width&amp;layout=button_count&amp;action=like&amp;show_faces=false&amp;show_count=false&amp;share=false&amp;height=21&amp;appId=507756515938786">
                </iframe>
              </div>
            </div>
          </div>

          <div class="column">
            <ul class="list-inline text-right">
              <li>
                <a href="/privacy">Privacy Policy</a>
              </li>

              <li>
                <a href="/terms">Terms of Service</a>
              </li>

              <li><span>¬© 2013-2015 Auth0 All Rights Reserved</span></li>
            </ul>
          </div>
        </div>
      </footer>
    </div>



    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js"></script>
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
    <script src="/blog/js/vendor/moment.min.js"></script>
    <script src="/blog/js/vendor/jquery.csbuttons.min.js"></script>
    <script type="text/javascript">
      (function () {
        var lock = window.lock = new Auth0Lock('zEYfpoFzUMEzilhkHilcWoNkrFfJ3hAI', 'auth0.auth0.com');
        var options = {
          callbackURL:    'https://manage.auth0.com/callback',
          dict: {
            signup: {
              footerText: 'By signing up, you agree to our <a href="/terms" target="_new">terms of service</a> and <a href="/privacy" target="_new">privacy policy</a>'
            }
          },
          icon: '//cdn.auth0.com/styleguide/latest/lib/logos/img/badge.png'
        };

        function getBasicInfo () {
          return {
            path: window.location.pathname,
            url: window.location.toString(),
            title: document.title,
            referrer: document.referrer,
            category: 'Lock',
            label: 'blog'
          }
        }

        lock.on('signup ready', function () {
          if (!window.analytics) return;
          window.analytics.track('open:signup', getBasicInfo());
        });

        lock.on('signin ready', function () {
          if (!window.analytics) return;
          window.analytics.track('open:signin', getBasicInfo());
        });

        lock.getClient().getSSOData(false, function (err, data) {
          if (!data || !data.sso) return;
          $('.login')
            .attr('href', 'https://manage.auth0.com')
            .html('Open Dashboard');
        });

        window.login = function login() {
          if (window.analytics) {
            window.analytics.track('click:signin', getBasicInfo());
          }
          lock.hide(function() {
            lock.show(options);
          });
        }

        window.signup = function() {
          if (window.analytics) {
            window.analytics.track('click:signup', getBasicInfo());
          }
          lock.hide(function() {
            lock.showSignup(options);
          });
        }
      })()
      
      $(function() {
        // Social Buttons
        $('.social-stats .network').cSButtons();

        // prettyPrint
        $('pre').addClass("prettyprint");

        // Force al content links to blank
        $('.entry-content a').each(function() {
          $(this).attr('target', '_blank');
        });

        $('.post-info time').each(function() {
          var $current = $(this);
          var dateString = $current.text();
          var diff = moment(dateString).diff(moment(new Date()), 'days');
          var dateFormat;

          dateFormat = moment(dateString).fromNow();

          if(diff > -10) {
            $current.text(dateFormat);
          }

          $current.addClass('rendered');
        });
      });

      $.fn.isOnScreen = function(){
        var win = $(window);
        var viewport = {
          top : win.scrollTop(),
          left : win.scrollLeft()
        };
        viewport.right = viewport.left + win.width();
        viewport.bottom = viewport.top + win.height();

        var bounds = win.offset();
        if (!bounds) return;

        bounds.right = bounds.left + win.outerWidth();
        bounds.bottom = bounds.top + win.outerHeight();

        return (!(viewport.right < bounds.left || viewport.left > bounds.right || viewport.bottom < bounds.top || viewport.top > bounds.bottom));
      };
    </script>

    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'auth0blog'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script'); s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
</body>
</html>
